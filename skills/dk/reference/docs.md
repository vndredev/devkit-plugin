# /dk docs - Documentation Management

**CRITICAL:** Manage all project documentation. YOU MUST keep docs in sync.

## Commands

| Command           | Description                     |
| ----------------- | ------------------------------- |
| `/dk docs`        | Show docs status (all files)    |
| `/dk docs update` | Update all docs from config     |
| `/dk docs init`   | Create missing docs             |
| `/dk docs arch`   | Generate/update ARCHITECTURE.md |
| `/dk docs plugin` | Generate/update PLUGIN.md       |
| `/dk docs claude` | Generate/update CLAUDE.md       |

## Managed Files

| File                   | Type        | Description                     |
| ---------------------- | ----------- | ------------------------------- |
| `CLAUDE.md`            | AUTO+CUSTOM | Project instructions for Claude |
| `docs/ARCHITECTURE.md` | AUTO        | Layer dependencies + diagrams   |
| `docs/PLUGIN.md`       | AUTO        | Plugin features documentation   |

## Workflow

### /dk docs

Show status of all documentation:

```bash
echo "=== Documentation Status ==="
echo ""
[ -f "CLAUDE.md" ] && echo "✓ CLAUDE.md" || echo "✗ CLAUDE.md (missing)"
[ -f "docs/ARCHITECTURE.md" ] && echo "✓ docs/ARCHITECTURE.md" || echo "✗ docs/ARCHITECTURE.md (missing)"
[ -f "docs/PLUGIN.md" ] && echo "✓ docs/PLUGIN.md" || echo "✗ docs/PLUGIN.md (missing)"
```

### /dk docs update

Update all documentation from config:

```bash
cd "${PLUGIN_ROOT}" && PYTHONPATH=src uv run python -c "
from lib.docs import update_claude_md, update_plugin_md
from arch.docs import update_architecture_md
from pathlib import Path
import os

os.chdir('${PROJECT_ROOT}')

print('Updating CLAUDE.md...')
ok, msg = update_claude_md()
print(f'  {\"✓\" if ok else \"✗\"} {msg}')

print('Updating docs/PLUGIN.md...')
ok, msg = update_plugin_md()
print(f'  {\"✓\" if ok else \"✗\"} {msg}')

print('Updating docs/ARCHITECTURE.md...')
ok, msg = update_architecture_md()
print(f'  {\"✓\" if ok else \"✗\"} {msg}')
"
```

### /dk docs init

Create all missing documentation:

```bash
cd "${PLUGIN_ROOT}" && PYTHONPATH=src uv run python -c "
from lib.docs import update_claude_md, update_plugin_md
from arch.docs import update_architecture_md
from pathlib import Path
import os

os.chdir('${PROJECT_ROOT}')

# Create docs/ directory if needed
Path('docs').mkdir(exist_ok=True)

print('Initializing documentation...')

if not Path('CLAUDE.md').exists():
    ok, msg = update_claude_md()
    print(f'  Created CLAUDE.md: {\"✓\" if ok else \"✗\"}')
else:
    print('  CLAUDE.md already exists')

if not Path('docs/PLUGIN.md').exists():
    ok, msg = update_plugin_md()
    print(f'  Created docs/PLUGIN.md: {\"✓\" if ok else \"✗\"}')
else:
    print('  docs/PLUGIN.md already exists')

if not Path('docs/ARCHITECTURE.md').exists():
    ok, msg = update_architecture_md()
    print(f'  Created docs/ARCHITECTURE.md: {\"✓\" if ok else \"✗\"}')
else:
    print('  docs/ARCHITECTURE.md already exists')
"
```

### /dk docs arch

Generate/update ARCHITECTURE.md specifically:

```bash
cd "${PLUGIN_ROOT}" && PYTHONPATH=src uv run python -c "
from arch.docs import update_architecture_md
import os
os.chdir('${PROJECT_ROOT}')
ok, msg = update_architecture_md()
print(f'{\"✓\" if ok else \"✗\"} {msg}')
"
```

### /dk docs plugin

Generate/update PLUGIN.md specifically:

```bash
cd "${PLUGIN_ROOT}" && PYTHONPATH=src uv run python -c "
from lib.docs import update_plugin_md
import os
os.chdir('${PROJECT_ROOT}')
ok, msg = update_plugin_md()
print(f'{\"✓\" if ok else \"✗\"} {msg}')
"
```

### /dk docs claude

Generate/update CLAUDE.md specifically:

```bash
cd "${PLUGIN_ROOT}" && PYTHONPATH=src uv run python -c "
from lib.docs import update_claude_md
import os
os.chdir('${PROJECT_ROOT}')
ok, msg = update_claude_md()
print(f'{\"✓\" if ok else \"✗\"} {msg}')
"
```

## CLAUDE.md Structure

### AUTO Sections (generated)

```markdown
<!-- AUTO:START - Generated by devkit-plugin. DO NOT EDIT. -->

## Principles

## Architecture

## Git Conventions

## Commands

## Development

<!-- AUTO:END -->
```

### CUSTOM Sections (preserved)

```markdown
<!-- CUSTOM:START - Your documentation below. Preserved during updates. -->

## Project Specific

_Add your documentation here._

<!-- CUSTOM:END -->
```

## ARCHITECTURE.md Content

Generated from `arch.layers` config + dependency analysis:

- Layer diagram (Mermaid)
- Dependency matrix
- Import rules
- Violation warnings

## PLUGIN.md Content

Generated from plugin configuration:

- Feature list
- Available commands
- Hook descriptions
- Configuration options

## Key Rules (MANDATORY)

**YOU MUST follow these rules:**

1. **YOU MUST run `/dk docs update` after config changes** - keeps all docs in sync
2. **NEVER edit AUTO sections manually** - they get overwritten
3. **ALWAYS put custom docs in CUSTOM sections** - they're preserved
4. **ALWAYS use `/dk docs init` for new projects** - creates proper structure

## External Documentation

When you need documentation beyond this project:

### Claude Code Questions

Use the `claude-code-guide` agent for:

- Hook configuration and formats
- Settings and configuration
- MCP server setup
- IDE integrations

### Library/Framework Documentation

Use Context7 MCP tools for up-to-date docs:

1. `mcp__plugin_context7_context7__resolve-library-id` - Find library ID
2. `mcp__plugin_context7_context7__query-docs` - Query documentation
